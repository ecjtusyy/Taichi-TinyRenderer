# ğŸ¨ Taichi TinyRendererï¼ˆè½¯æ …æ ¼æ¸²æŸ“å™¨ï¼‰

ä¸€ä¸ªç”¨ **Python + Taichi** ç¼–å†™çš„æç®€è½¯æ¸²æŸ“å™¨ï¼Œå‚è€ƒ **TinyRenderer** æ€è·¯ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

- **ç›¸æœº**ï¼šLookAt / é€è§†æŠ•å½± / è§†å£å˜æ¢  
- **å‡ ä½•å¤„ç†**ï¼šèƒŒé¢å‰”é™¤  
- **å…‰æ …åŒ–**ï¼šä¸‰è§’å½¢é‡å¿ƒåæ ‡å¡«å…… + Z-Buffer æ·±åº¦æµ‹è¯•  
- **ç€è‰²**ï¼šLambert æ¼«åå°„ï¼ˆå¯è°ƒæ–¹å‘å…‰ï¼‰  
- **çº¹ç†ï¼ˆå¯é€‰ï¼‰**ï¼šæœ€è¿‘é‚»é‡‡æ ·ï¼ˆå½“å‰ä¸ºå±å¹•ç©ºé—´æ’å€¼ï¼Œåç»­è®¡åˆ’æ”¯æŒé€è§†æ ¡æ­£ï¼‰  

> ğŸ¯ ç›®æ ‡ï¼šå­¦ä¹ å›¾å½¢å­¦åŸºç¡€ã€æ­å»ºä¸€ä¸ªå¹²å‡€å¯æ‰©å±•çš„æ•™å­¦/å®éªŒéª¨æ¶ï¼Œå¹¶åœ¨å¤šåç«¯ï¼ˆVulkan / CUDA / OpenGL / CPUï¼‰ä¸Šè¿è¡Œã€‚

---

## ğŸ“‚ ç›®å½•

- [ç¯å¢ƒä¸å®‰è£…](#ç¯å¢ƒä¸å®‰è£…)
- [å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ— çº¹ç† Demoï¼‰](#å¿«é€Ÿä¸Šæ‰‹æ— çº¹ç†-demo)
- [å¸¦çº¹ç†çš„ä½¿ç”¨æ–¹å¼](#å¸¦çº¹ç†çš„ä½¿ç”¨æ–¹å¼)
- [å‘½ä»¤è¡Œå‚æ•°è¯´æ˜](#å‘½ä»¤è¡Œå‚æ•°è¯´æ˜)
- [å¸¸è§é—®é¢˜ä¸æ’æŸ¥](#å¸¸è§é—®é¢˜ä¸æ’æŸ¥)
- [é¡¹ç›®ç»“æ„å»ºè®®](#é¡¹ç›®ç»“æ„å»ºè®®)
- [Roadmap](#roadmap)
- [è®¸å¯è¯](#è®¸å¯è¯)
- [å¼•ç”¨ä¸è‡´è°¢](#å¼•ç”¨ä¸è‡´è°¢)

---

## ğŸ§© ç¯å¢ƒä¸å®‰è£…

**ä¾èµ–ç¯å¢ƒï¼š**
- Python â‰¥ 3.8  
- æ¨è **Taichi â‰¥ 1.6**ï¼ˆ1.7 ä¹Ÿå¯ï¼‰  
- å…¶ä»–ä¾èµ–ï¼š`numpy`

å®‰è£… Taichiï¼ˆä¼šè‡ªåŠ¨å®‰è£… numpyï¼‰ï¼š
```bash
pip install taichi
````

> æœ¬é¡¹ç›®å†…ç½®äº†â€œå¤šåç«¯åˆå§‹åŒ–â€é€»è¾‘ï¼šæŒ‰ **Vulkan â†’ CUDA â†’ OpenGL â†’ CPU** çš„ä¼˜å…ˆçº§å°è¯•ï¼›
> èƒ½è·‘å“ªä¸ªå°±è‡ªåŠ¨ç”¨å“ªä¸ªï¼Œå› æ­¤æ— éœ€æ‰‹åŠ¨åˆ¤æ–­ `cuda_available()`ã€‚

---

## ğŸš€ å¿«é€Ÿä¸Šæ‰‹ï¼ˆæ— çº¹ç† Demoï¼‰

å‡†å¤‡ä¸€ä¸ªæœ€å°ä¸‰è§’å½¢ OBJï¼š

```bash
cat > single_triangle.obj << 'EOF'
# Single triangle in XY plane (Z=0)
v  -0.8 -0.6  0.0
v   0.8 -0.6  0.0
v   0.0  0.7  0.0
f 1 2 3
EOF
```

è¿è¡Œæ¸²æŸ“ï¼š

```bash
python main.py --obj single_triangle.obj --out triangle_out.png \
  --width 512 --height 512 \
  --eye 0 0 3 --center 0 0 0 --up 0 1 0
```

çœ‹åˆ°ç»ˆç«¯æ‰“å°ï¼š

```
[OK] Saved image to triangle_out.png
```

å³è¡¨ç¤ºæ¸²æŸ“æˆåŠŸã€‚

---

## ğŸ–¼ å¸¦çº¹ç†çš„ä½¿ç”¨æ–¹å¼

éœ€è¦ä¸€ä¸ªå¸¦ `vt` çš„ OBJ ä¸ä¸€å¼ çº¹ç†å›¾ç‰‡ï¼ˆPNG / JPGï¼‰ï¼š

```bash
python main.py \
  --obj path/to/your_model_with_vt.obj \
  --texture path/to/diffuse.png \
  --out textured_out.png \
  --width 800 --height 800 \
  --eye 1 1 3 --center 0 0 0 --up 0 1 0
```

> ğŸ’¡ è¯´æ˜ï¼šå½“å‰çº¹ç†åæ ‡åœ¨ç‰‡å…ƒé˜¶æ®µåš**çº¿æ€§æ’å€¼**ï¼ˆè¶³å¤Ÿåº”ä»˜å¤§å¤šæ•°æµ‹è¯•ï¼‰ï¼Œ
> å¦‚éœ€ **ä¸¥æ ¼é€è§†æ ¡æ­£ï¼ˆuv/wï¼‰** ä¸ **Phong æ³•çº¿æ’å€¼**ï¼Œè§ä¸‹æ–¹ Roadmapã€‚

---

## âš™ï¸ å‘½ä»¤è¡Œå‚æ•°è¯´æ˜

| å‚æ•°                     | è¯´æ˜                                        |
| ---------------------- | ----------------------------------------- |
| `--obj`                | **å¿…å¡«**ï¼ŒOBJ æ¨¡å‹è·¯å¾„ï¼ˆæ”¯æŒ v / vt / fï¼›å¤šè¾¹å½¢è‡ªåŠ¨æ‰‡å½¢ä¸‰è§’åŒ–ï¼‰ |
| `--texture`            | å¯é€‰ï¼Œçº¹ç†å›¾ç‰‡è·¯å¾„ï¼ˆPNG/JPGï¼Œéœ€è¦ OBJ å« vtï¼‰            |
| `--out`                | è¾“å‡ºå›¾ç‰‡åï¼Œé»˜è®¤ `out.png`                        |
| `--width` / `--height` | è¾“å‡ºå›¾åƒå°ºå¯¸ï¼Œé»˜è®¤ 800Ã—800                         |
| `--fov`                | å‚ç›´è§†è§’ï¼ˆåº¦ï¼‰ï¼Œé»˜è®¤ 60                             |
| `--near` / `--far`     | è¿‘è£å‰ªé¢ / è¿œè£å‰ªé¢ï¼Œé»˜è®¤ 0.1 / 100                  |
| `--eye`                | ç›¸æœºä½ç½®ï¼ˆx y zï¼‰                               |
| `--center`             | ç›¸æœºçœ‹å‘ç‚¹ï¼ˆx y zï¼‰                              |
| `--up`                 | ç›¸æœºä¸Šæ–¹å‘ï¼ˆx y zï¼‰                              |
| `--bg`                 | èƒŒæ™¯è‰² RGBï¼Œé»˜è®¤ `0.05 0.05 0.08`               |
| `--light`              | æ–¹å‘å…‰å‘é‡ï¼ˆä¸–ç•Œç©ºé—´ï¼‰ï¼Œé»˜è®¤ `0.5 1.0 0.3`              |

---

## ğŸ§  å®é™…æ¸²æŸ“æµç¨‹

1. **LookAt** â†’ ç”Ÿæˆè§†å›¾çŸ©é˜µ
2. **Perspective** â†’ ç”ŸæˆæŠ•å½±çŸ©é˜µ
3. å¾—åˆ° PVï¼ˆProjection Ã— Viewï¼‰çŸ©é˜µ
4. é¡¶ç‚¹å˜æ¢åˆ° NDCï¼Œå†æ˜ å°„åˆ°å±å¹•åƒç´ åæ ‡
5. èƒŒé¢å‰”é™¤
6. åŒ…å›´ç›’æ‰«æ + é‡å¿ƒåæ ‡åˆ¤æ–­è¦†ç›–
7. æ·±åº¦æµ‹è¯• + æ¼«åå°„ç€è‰²ï¼ˆå¯é‡‡æ ·çº¹ç†ï¼‰

---

## â“ å¸¸è§é—®é¢˜ä¸æ’æŸ¥

**Q1ï¼šåˆå§‹åŒ–æ—¶æŠ¥é”™ / åç«¯ä¸å¯ç”¨**
ğŸ‘‰ è‡ªåŠ¨å°è¯•åç«¯é¡ºåºä¸º Vulkan â†’ CUDA â†’ OpenGL â†’ CPUï¼›
å¦‚å…¨éƒ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š

* æ˜¾å¡é©±åŠ¨ï¼›
* `vulkaninfo` è¾“å‡ºï¼›
* æ˜¯å¦æœ‰æ˜¾ç¤ºç¯å¢ƒï¼ˆOpenGL éœ€å›¾å½¢ç¯å¢ƒï¼‰ã€‚

---

**Q2ï¼šè¾“å‡ºå…¨é»‘ / å¾ˆæš—**

* è¯•è¯•è°ƒæ•´å…‰ç…§æ–¹å‘ï¼š`--light 0 0 1`ï¼›
* æ¨¡å‹æ³•çº¿æ˜¯é€šè¿‡ä¸‰è§’é¢ä¸–ç•Œåæ ‡å‰ä¹˜è·å¾—ï¼ŒèƒŒé¢ä¼šè¢«å‰”é™¤æˆ–äº®åº¦ä½ã€‚

---

**Q3ï¼šåŠ è½½äº†çº¹ç†ä½†çœ‹ä¸åˆ°**

* ç¡®è®¤ OBJ å« `vt`ï¼›
* å‘½ä»¤è¡Œä¼ å…¥äº† `--texture`ï¼›
* çº¹ç† V è½´åœ¨é‡‡æ ·å‡½æ•°ä¸­åšäº†ç¿»è½¬ï¼Œå¦‚é¢ å€’è¯·æ£€æŸ¥çº¹ç†åæ ‡æ–¹å‘ã€‚

---

**Q4ï¼šOBJ è¯»ä¸å‡ºæ¥**

* å½“å‰åŠ è½½å™¨ä¸º**æœ€å°å¯ç”¨ç‰ˆ**ï¼Œæ”¯æŒ v / vt / fï¼›
* ä¸æ”¯æŒå¤æ‚ç‰¹æ€§ï¼ˆæ³•çº¿ã€æè´¨ã€MTL æ–‡ä»¶ï¼‰ï¼›
* å¤šè¾¹å½¢é¢ä¼šè‡ªåŠ¨**æ‰‡å½¢ä¸‰è§’åŒ–**ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„å»ºè®®

### æœ€å°ç»“æ„ï¼ˆå³å¯è¿è¡Œï¼‰

```
.
â”œâ”€â”€ main.py                  # æ¸²æŸ“å™¨ä¸»ç¨‹åºï¼ˆTaichi å†…æ ¸ + OBJ åŠ è½½ + ç®¡çº¿æ‹¼è£…ï¼‰
â”œâ”€â”€ single_triangle.obj      # å¯é€‰ï¼šæœ€å° Demoï¼ˆæ— çº¹ç†ï¼‰
â””â”€â”€ README.md                # æœ¬æ–‡ä»¶
```

### å«çº¹ç†ä¸æ¨¡å‹çš„æ¨èç»“æ„

```
.
â”œâ”€â”€ main.py
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ models/xxx.obj
â”‚   â””â”€â”€ textures/diffuse.png
â””â”€â”€ README.md
```

---

## ğŸ§­ Roadmap

* [ ] ä¸¥æ ¼é€è§†æ ¡æ­£çº¹ç†ï¼ˆæ’å€¼ uv/w ä¸ 1/wï¼Œç‰‡å…ƒé˜¶æ®µè¿˜åŸï¼‰
* [ ] Phong æ³•çº¿æ’å€¼ï¼ˆè§£æ vnï¼Œé¡¶ç‚¹æ³•çº¿é‡å¿ƒæ’å€¼ + å½’ä¸€åŒ–ï¼‰
* [ ] çº¿æ¡†æ¨¡å¼ / æ·±åº¦å›¾ / UV å¯è§†åŒ–ï¼ˆè°ƒè¯•ä¸æ•™å­¦ï¼‰
* [ ] é˜´å½±æ˜ å°„ï¼ˆShadow Mapï¼‰
* [ ] Tile-based å¹¶è¡Œæ …æ ¼åŒ–ï¼ˆæé«˜ç¼“å­˜å±€éƒ¨æ€§ä¸å¹¶è¡Œåº¦ï¼‰
* [ ] æ›´å®Œæ•´çš„ OBJ/MTL æ”¯æŒï¼ˆæ¼«åå°„ã€é•œé¢ã€æ³•çº¿è´´å›¾ç­‰ï¼‰

> ğŸ’¡ å¦‚æœä½ éœ€è¦ï¼Œæˆ‘å¯ä»¥æä¾›æœ€å°å¢é‡è¡¥ä¸æ¥å®ç°ä¸Šè¿°ä»»æ„ä¸€æ¡ã€‚

---

## ğŸ“œ è®¸å¯è¯

å»ºè®®ä½¿ç”¨ **MIT License**ï¼ˆå¼€æºå‹å¥½ï¼Œå¯å•†ç”¨ï¼‰ã€‚
å¦‚éœ€ç”Ÿæˆæ ‡å‡† LICENSE æ–‡ä»¶ï¼Œå¯ç›´æ¥ä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼š

```text
MIT License
Copyright (c) 2025 <Your Name>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction...
```

---

## ğŸ™ å¼•ç”¨ä¸è‡´è°¢

* å­¦ä¹ è·¯çº¿å‚è€ƒï¼š[GAMES101 / 102 / 201](https://games-cn.org/)
* å®ç°æ€è·¯å‚è€ƒï¼š**TinyRendererï¼ˆæ•™å­¦ç”¨ï¼‰**
* æ¡†æ¶ä¸å¹¶è¡Œåç«¯æ”¯æŒï¼š**Taichi**

---

```
```
